<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Introducing async HTTP requests with ReactPHP</title>
    <link href="../src/landing-page.v2.css" rel="stylesheet">
    <link href="../src/tailwind.min.css" rel="stylesheet">
    <link rel="alternate" type="application/atom+xml" href="../posts.atom" title="Recent blog posts" />
    <script defer data-domain="clue.engineering" src="https://plausible.io/js/script.outbound-links.js"></script>

    <meta name="description" content="Today, I&#039;m happy to announce the v2.5.0 release of clue/reactphp-buzz, the simple, async PSR-7 HTTP client for concurrently processing any number of HTTP requests, built on top of ReactPHP. ðŸŽ‰  As the version number suggests, this is not exactly a new project. In fact, this has been used inâ€¦">
    <meta property="og:type" content="article">
    <meta property="og:title" content="Introducing async HTTP requests with ReactPHP">
    <meta property="og:description" content="Today, I&#039;m happy to announce the v2.5.0 release of clue/reactphp-buzz, the simple, async PSR-7 HTTP client for concurrently processing any number of HTTP requests, built on top of ReactPHP. ðŸŽ‰  As the version number suggests, this is not exactly a new project. In fact, this has been used inâ€¦">
    <meta property="og:url" content="https://clue.engineering/2018/introducing-reactphp-buzz">
    <meta property="og:site_name" content="clueÂ·engineering">
    <meta property="article:published_time" content="2018-10-24">
    <meta name="twitter:site" content="@another_clue">
    <meta name="twitter:creator" content="@another_clue">
</head>

<body>
    <header class="bg-gray-800">
      <div class="relative">
        <div class="flex justify-between items-center max-w-3xl mx-auto px-1 py-1">
          <div class="flex justify-start">
            <a href="../" class="text-white py-1 px-1 hover:text-blue-100">
              <strong>clue</strong>Â·engineering
            </a>
          </div>
          
          <nav class="flex justify-end items-center space-x-1 sm:space-x-8">
            <a href="../blog" class="text-base text-gray-300 hover:text-gray-200">
              Blog
            </a>
            <a href="../talks" class="text-base text-gray-300 hover:text-gray-200">
              Talks
            </a>
            <a href="../support" class="ml-8 whitespace-nowrap inline-flex items-center justify-center px-1 sm:px-4 py-1 border border-transparent rounded-md shadow-sm text-base font-medium text-white bg-blue-500 hover:bg-blue-400">
              <span class="hidden sm:inline sm:mr-1">Professional</span> Services
            </a>
          </nav>
        </div>
      </div>
    </header>

    <section id="post">
        <div class="container">
            <article>
                <h1>Introducing async HTTP requests with ReactPHP</h1>
                <div>
                    <address>
                        <img src="../src/me.jpg" alt="Christian LÃ¼ck Portrait Photo">
                        <a href="../">Christian LÃ¼ck</a>
                    </address>
                    on <time datetime="2018-10-24">2018-10-24</time>
                    <div>
                        tagged
                        <a href="../blog#introducing-reactphp" title="Show all blog posts tagged #introducing-reactphp" rel="tag">#introducing-reactphp</a>
                        <a href="../blog#reactphp" title="Show all blog posts tagged #reactphp" rel="tag">#reactphp</a>
                        <a href="../blog#release" title="Show all blog posts tagged #release" rel="tag">#release</a>
                        <a href="../blog#http" title="Show all blog posts tagged #http" rel="tag">#http</a>
                        <a href="../blog#concurrency" title="Show all blog posts tagged #concurrency" rel="tag">#concurrency</a>
                    </div>
                </div>

<p>Today, I'm happy to announce the <code>v2.5.0</code> release of <a href="https://github.com/clue/reactphp-buzz">clue/reactphp-buzz</a>,
the simple, async PSR-7 HTTP client for concurrently processing any number of HTTP requests, built on top of <a href="https://reactphp.org/">ReactPHP</a>. ðŸŽ‰</p>

<p>As the version number suggests, this is not exactly a new project. In fact, this has been used in production in a larger number of projects for a few years already. So I guess it's about time to write an introductory blog post about this project, why async HTTP requests are such a powerful feature and also a bit about the motivation for this project and why I think ReactPHP is a perfect fit for sending HTTP requests.</p>

<h2 id="http-all-the-things%21">HTTP all the things!</h2>

<p>I'm probably not telling you something new when I say the web is built on top of HTTP. This blog post is served over HTTP. Your YouTube videos are served over HTTP. Your downloads are served over HTTP. RESTful backend APIs are served over HTTP. GraphQL APIs are served over HTTP. SOAP APIs are served over HTTP. Yes, I may be oversimplifying things a bit here, but I think you get the point.</p>

<p>With HTTP being so ubiquitous, I'm happy to let you know that using it with ReactPHP is just a few lines of code away:</p>

<pre><code class="php">$loop = \React\EventLoop\Factory::create();
$client = new \Clue\React\Buzz\Browser($loop);

$client-&gt;get('https://api.example.com/')-&gt;then(function (ResponseInterface $response) {
    var_dump($response-&gt;getHeaders(), (string)$response-&gt;getBody());
});

$loop-&gt;run();
</code></pre>

<p>Now if you're entirely new to this project, I should probably mention that you have to install it first (Who would have guessed that?). A single <code>composer require clue/buzz-react:^2.5</code> command does this for you.</p>

<p>If you've never worked with ReactPHP and async APIs in PHP before, the <code>$loop</code> boilerplate around the middle part may look a bit strange to you, so let's ignore this for a moment. Other than that, if you've ever worked with Guzzle or Buzz or pretty much any other HTTP client in PHP, it should be pretty obvious that the <code>get()</code> method sends a <code>GET</code> request and this code will simply dump all HTTP response headers and the full HTTP response body to the output. Because all these projects use <a href="https://www.php-fig.org/psr/psr-7/">PSR-7</a> interfaces to represent HTTP messages, there's a fair chance you might be familiar with this piece of code already. For comparision, let's take a look at the same example with Guzzle:</p>

<pre><code class="php">$client = new \GuzzleHttp\Client();

$response = $client-&gt;get('https://api.example.com/');
var_dump($response-&gt;getHeaders(), (string)$response-&gt;getBody());
</code></pre>

<h2 id="concurrent-http-requests">Concurrent HTTP requests</h2>

<p>If we only ever send a single HTTP request, both examples above will do pretty much the same thing and it would be hard to argue that either example is "better". Now again with HTTP being so ubiquitous, there's a fair chance we will have to issue more than one request in our application, so let's take a look at that:</p>

<pre><code class="php">$loop = \React\EventLoop\Factory::create();
$client = new \Clue\React\Buzz\Browser($loop);

$client-&gt;get('https://api.example.com/users/alice')-&gt;then(function (ResponseInterface $response) {
    var_dump($response-&gt;getHeaders(), (string)$response-&gt;getBody());
});

$client-&gt;get('https://api.example.com/users/bob')-&gt;then(function (ResponseInterface $response) {
    var_dump($response-&gt;getHeaders(), (string)$response-&gt;getBody());
});

$loop-&gt;run();
</code></pre>

<p>It should be no surprise that this example will send two independent <code>GET</code> requests and will again dump their responses. What is worth noting, however, is how this is executed. Being entirely async, this piece of code will actually send two requests <em>concurrently</em>.</p>

<p><strong>1 + 1 = 1?</strong></p>

<p>What this means, in a gist, is that if a single request takes 1 second to complete, then two requests will also take just 1 second (assuming ideal network conditions). By leveraging non-blocking I/O, actually sending the HTTP request over the wire and receiving the HTTP response takes close to zero seconds. Most of the time will only be spend <em>waiting</em> for the remote server to actually serve the request. This is not just some theoretical construct, but something that bears some very real real-world performance improvements.</p>

<p>Depending mostly on what kind of load the receiving side is willing to accept, this approach scales very well to around a dozen or so concurrent requests. If you want to send a larger number of requests, you may want to take a look at one of the previous blog posts introducing an <a href="https://clue.engineering/2018/introducing-reactphp-mq">in-memory queue</a> or <a href="https://clue.engineering/2018/introducing-reactphp-flux">managing flux</a> to throttle your sending side to limit concurrency to whatever limit works best for your specific use case.</p>

<h2 id="conclusions">Conclusions</h2>

<p>HTTP is everywhere. This makes <a href="https://github.com/clue/reactphp-buzz">clue/reactphp-buzz</a> an important piece of the puzzle of bringing ReactPHP to the masses. It features some very efficient code to process a large number of requests for a large number of different use-cases. Among others, it can be used for <a href="https://sergeyzhuk.me/2018/02/12/fast-webscraping-with-reactphp/">scaping the web</a>, <a href="https://sergeyzhuk.me/2018/03/19/fast-webscraping-with-reactphp-limiting-requests/">throttling requests</a> or <a href="https://sergeyzhuk.me/2018/06/20/fast-webscraping-with-reactphp-proxy/">using proxy servers</a>. A non-trivial amount of effort is spent on ensuring its APIs are well thought out and well documented. Again, this post is barely touching the surface of all the features and how this can be used, but I'll leave this up for another post soon-ish.</p>

<p>If you want to learn more about this project, make sure to check out the project homepage of <a href="https://github.com/clue/reactphp-buzz">clue/reactphp-buzz</a>. It should provide most of the features you would expect from an HTTP client in PHP (authentication, redirects, timeouts, custom headers, proxy server support etc.). If you like this project, spreading the word is much appreciated! If you have any feedback or just want to reach out and say hello, I'm happy to hear back and appreciate feedback! Use the contact options in the section below and let's get in touch.</p>

<blockquote class="twitter-tweet" data-lang="de"><p lang="en" dir="ltr">Just released clue/reactphp-buzz v2.5.0! ðŸŽ‰ It features everything you would expect from an async HTTP client in PHP, including timeout support and revamped documentation! Efficiently process large number of HTTP requests with @ReactpPHP. <a href="https://twitter.com/hashtag/async?src=hash&amp;ref_src=twsrc%5Etfw">#async</a> <a href="https://twitter.com/hashtag/php?src=hash&amp;ref_src=twsrc%5Etfw">#php</a> <a href="https://t.co/WpvciAVJxC">https://t.co/WpvciAVJxC</a></p>&mdash; Christian LÃ¼ck (@another_clue) <a href="https://twitter.com/another_clue/status/1055162680208773121?ref_src=twsrc%5Etfw">24. Oktober 2018</a></blockquote>
            </article>
        </div>
    </section>

    <section id="calendly">
        <div class="bg-white">
            <div class="max-w-5xl mx-auto py-16 px-4 sm:px-6 lg:px-8">
                <div class="bg-gray-800 rounded-lg shadow-xl overflow-hidden lg:grid lg:grid-cols-2 lg:gap-4">
                    <div class="pt-10 pb-12 px-6 sm:pt-16 sm:px-16 lg:py-16 lg:pr-0 xl:py-10 xl:px-10">
                        <div class="lg:self-center">
                            <h2 class="text-3xl font-extrabold text-white sm:text-4xl">
                                <span class="block">We're Here to Help!</span>
                                <span class="block text-blue-400">Let's Tackle Your Problems Together.</span>
                            </h2>
                            <p class="mt-4 text-lg leading-6 text-gray-200">
                                Did you know we provide <a href="https://clue.engineering/support" class="underline">professional support</a> for software projects?
                                Book an appointment, you pay absolutely nothing for the first consultation.
                            </p>
                            <a href="https://calendly.com/clue-engineering/getting-started" class="mt-8 bg-blue-400 hover:bg-blue-500 border border-transparent rounded-md shadow px-5 py-3 inline-flex items-center text-base font-medium text-white">Set Up a Free Call</a>
                        </div>
                    </div>
                    <div class="-mt-6 aspect-w-5 aspect-h-3 md:aspect-w-2 md:aspect-h-1">
                        <a href="https://calendly.com/clue-engineering/getting-started">
                            <img class="transform translate-x-16 translate-y-6 rounded-md object-cover object-left-top sm:translate-x-24 lg:translate-y-24 lg:translate-x-16" src="../src/2023-calendly.png" alt="calendly screenshot">
                        </a>
                    </div>
                </div>
            </div>
        </div>
    </section>

    <section id="share">
        <div class="container">
            <h3>
                <a href="#share"></a>
                We love feedback!
            </h3>
            <p>
                If you have anything to add,
                send a tweet to <a href="https://twitter.com/another_clue">@another_clue</a>.
            </p>
            <p>
                We invite you to share our blog posts with friends and colleagues.
                All our blog posts can be shared freely under the permissive
                <a href="https://creativecommons.org/licenses/by/4.0/">CC-BY</a>
                license.
            </p>
            <p>
                <!-- Thank you! https://fontawesome.com/ (solid/envelope) -->
                <svg viewBox="0 0 512 512"><path d="M502.3 190.8c3.9-3.1 9.7-.2 9.7 4.7V400c0 26.5-21.5 48-48 48H48c-26.5 0-48-21.5-48-48V195.6c0-5 5.7-7.8 9.7-4.7 22.4 17.4 52.1 39.5 154.1 113.6 21.1 15.4 56.7 47.8 92.2 47.6 35.7.3 72-32.8 92.3-47.6 102-74.1 131.6-96.3 154-113.7zM256 320c23.2.4 56.6-29.2 73.4-41.4 132.7-96.3 142.8-104.7 173.4-128.7 5.8-4.5 9.2-11.5 9.2-18.9v-19c0-26.5-21.5-48-48-48H48C21.5 64 0 85.5 0 112v19c0 7.4 3.4 14.3 9.2 18.9 30.6 23.9 40.7 32.4 173.4 128.7 16.8 12.2 50.2 41.8 73.4 41.4z"/></svg>
                <a href="../contact">Email us</a> if you think we should be working together on interesting projects.
            </p>
        </div>
    </section>

    <footer class="bg-gray-800">
      <div class="max-w-7xl mx-auto py-12 px-4 overflow-hidden sm:px-6 lg:px-8">
        <nav class="-mx-5 -my-2 flex flex-wrap justify-center" aria-label="Footer">
          <div class="px-5 py-2">
            <a href="../" class="text-base text-gray-400 hover:text-gray-300">
              Home
            </a>
          </div>

          <div class="px-5 py-2">
            <a href="../support" class="text-base text-gray-400 hover:text-gray-300">
              Services
            </a>
          </div>

          <div class="px-5 py-2">
            <a href="../blog" class="text-base text-gray-400 hover:text-gray-300">
              Blog
            </a>
          </div>

          <div class="px-5 py-2">
            <a href="../talks" class="text-base text-gray-400 hover:text-gray-300">
              Talks
            </a>
          </div>

          <div class="px-5 py-2">
            <a href="../contact" class="text-base text-gray-400 hover:text-gray-300">
              Contact
            </a>
          </div>


          <div class="px-5 py-2">
            <a href="../contact#imprint" class="text-base text-gray-400 hover:text-gray-300">
              Imprint
            </a>
          </div>
        </nav>
        <div class="mt-8 flex justify-center space-x-6">
          <a href="https://twitter.com/another_clue" title="@another_clue on Twitter" class="text-gray-400 hover:text-gray-300">
            <span class="sr-only">Twitter</span>
            <svg class="h-6 w-6" fill="currentColor" viewBox="0 0 24 24" aria-hidden="true">
              <path d="M8.29 20.251c7.547 0 11.675-6.253 11.675-11.675 0-.178 0-.355-.012-.53A8.348 8.348 0 0022 5.92a8.19 8.19 0 01-2.357.646 4.118 4.118 0 001.804-2.27 8.224 8.224 0 01-2.605.996 4.107 4.107 0 00-6.993 3.743 11.65 11.65 0 01-8.457-4.287 4.106 4.106 0 001.27 5.477A4.072 4.072 0 012.8 9.713v.052a4.105 4.105 0 003.292 4.022 4.095 4.095 0 01-1.853.07 4.108 4.108 0 003.834 2.85A8.233 8.233 0 012 18.407a11.616 11.616 0 006.29 1.84" />
            </svg>
          </a>
    
          <a href="https://github.com/clue" title="@clue on GitHub" class="text-gray-400 hover:text-gray-300">
            <span class="sr-only">GitHub</span>
            <svg class="h-6 w-6" fill="currentColor" viewBox="0 0 24 24" aria-hidden="true">
              <path fill-rule="evenodd" d="M12 2C6.477 2 2 6.484 2 12.017c0 4.425 2.865 8.18 6.839 9.504.5.092.682-.217.682-.483 0-.237-.008-.868-.013-1.703-2.782.605-3.369-1.343-3.369-1.343-.454-1.158-1.11-1.466-1.11-1.466-.908-.62.069-.608.069-.608 1.003.07 1.531 1.032 1.531 1.032.892 1.53 2.341 1.088 2.91.832.092-.647.35-1.088.636-1.338-2.22-.253-4.555-1.113-4.555-4.951 0-1.093.39-1.988 1.029-2.688-.103-.253-.446-1.272.098-2.65 0 0 .84-.27 2.75 1.026A9.564 9.564 0 0112 6.844c.85.004 1.705.115 2.504.337 1.909-1.296 2.747-1.027 2.747-1.027.546 1.379.202 2.398.1 2.651.64.7 1.028 1.595 1.028 2.688 0 3.848-2.339 4.695-4.566 4.943.359.309.678.92.678 1.855 0 1.338-.012 2.419-.012 2.747 0 .268.18.58.688.482A10.019 10.019 0 0022 12.017C22 6.484 17.522 2 12 2z" clip-rule="evenodd" />
            </svg>
          </a>
        </div>
      </div>
    </footer>
</body>
</html>
